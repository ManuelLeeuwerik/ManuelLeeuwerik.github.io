<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Single-cell immune receptor profiling | Portfolio Manuel Leeuwerik</title>
  <meta name="description" content="3 Single-cell immune receptor profiling | Portfolio Manuel Leeuwerik" />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Single-cell immune receptor profiling | Portfolio Manuel Leeuwerik" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Single-cell immune receptor profiling | Portfolio Manuel Leeuwerik" />
  
  
  

<meta name="author" content="Manuel Leeuwerik" />


<meta name="date" content="2024-12-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="CV.html"/>
<link rel="next" href="Ga.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introductie</a></li>
<li class="chapter" data-level="2" data-path="CV.html"><a href="CV.html"><i class="fa fa-check"></i><b>2</b> Curriculum Vitae</a></li>
<li class="chapter" data-level="3" data-path="scRepertoire.html"><a href="scRepertoire.html"><i class="fa fa-check"></i><b>3</b> Single-cell immune receptor profiling</a>
<ul>
<li class="chapter" data-level="3.1" data-path="scRepertoire.html"><a href="scRepertoire.html#planning"><i class="fa fa-check"></i><b>3.1</b> Planning</a></li>
<li class="chapter" data-level="3.2" data-path="scRepertoire.html"><a href="scRepertoire.html#bronvermelding"><i class="fa fa-check"></i><b>3.2</b> Bronvermelding</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="Ga.html"><a href="Ga.html"><i class="fa fa-check"></i><b>4</b> Guerrila analytics</a></li>
<li class="chapter" data-level="5" data-path="c.-elegans-plate-experiment.html"><a href="c.-elegans-plate-experiment.html"><i class="fa fa-check"></i><b>5</b> C. elegans plate experiment</a>
<ul>
<li class="chapter" data-level="5.1" data-path="c.-elegans-plate-experiment.html"><a href="c.-elegans-plate-experiment.html#inleiding"><i class="fa fa-check"></i><b>5.1</b> Inleiding</a></li>
<li class="chapter" data-level="5.2" data-path="c.-elegans-plate-experiment.html"><a href="c.-elegans-plate-experiment.html#inspecteren-data-types"><i class="fa fa-check"></i><b>5.2</b> Inspecteren data types</a></li>
<li class="chapter" data-level="5.3" data-path="c.-elegans-plate-experiment.html"><a href="c.-elegans-plate-experiment.html#scatterplot"><i class="fa fa-check"></i><b>5.3</b> Scatterplot</a></li>
<li class="chapter" data-level="5.4" data-path="c.-elegans-plate-experiment.html"><a href="c.-elegans-plate-experiment.html#dosis-response-curves"><i class="fa fa-check"></i><b>5.4</b> Dosis-response curves</a></li>
<li class="chapter" data-level="5.5" data-path="c.-elegans-plate-experiment.html"><a href="c.-elegans-plate-experiment.html#conclusie"><i class="fa fa-check"></i><b>5.5</b> Conclusie</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="peer.html"><a href="peer.html"><i class="fa fa-check"></i><b>6</b> Open Peer Review</a>
<ul>
<li class="chapter" data-level="6.1" data-path="peer.html"><a href="peer.html#references"><i class="fa fa-check"></i><b>6.1</b> References</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="package.html"><a href="package.html"><i class="fa fa-check"></i><b>7</b> A new R package</a>
<ul>
<li class="chapter" data-level="7.1" data-path="package.html"><a href="package.html#spotting-penguins"><i class="fa fa-check"></i><b>7.1</b> Spotting penguins</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Portfolio Manuel Leeuwerik</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="scRepertoire" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">3</span> Single-cell immune receptor profiling<a href="scRepertoire.html#scRepertoire" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Vanwege mijn interesse in immunologie ga ik een analyse/package leren voor ‘single-cell immune receptor profiling’. Deze analyse maakt een profiel voor individuele cellen en onderzoekt T-cell receptoren (TCR) en immunoglobulinen (Ig). Hierbij wordt scRNA sequencing data omgezet in onder andere V/D/J libraries. Met behulp van de scRepertoire package kunnen deze V(D)J-segmenten en CDR3-regio’s geanalyseerd worden (Borcherding N., 2023). Door de verschillende clonotypes te identificeren, kan men uitspraken doen over immuunresponsen, die vervolgens gekoppeld kunnen worden aan specifieke infecties of vaccinaties (CeGaT GmbH, 2024).</p>
<p>De scRepertoire package is afkomstig van: <em><a href="https://github.com/ncborcherding/scRepertoire">https://github.com/ncborcherding/scRepertoire</a> Borcherding, N, Yang, Q, &amp; Safina, K. (2024). scRepertoire v2: A toolkit for single-cell immune receptor profiling. DOI: 10.18129/B9.bioc.scRepertoire</em></p>
<p>Om deze package te leren maak ik gebruik van de tutorial ‘Starting work with scRepertoire’: <em><a href="https://www.bioconductor.org/packages/devel/bioc/vignettes/scRepertoire/inst/doc/vignette.html">https://www.bioconductor.org/packages/devel/bioc/vignettes/scRepertoire/inst/doc/vignette.html</a>.</em></p>
<div id="planning" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Planning<a href="scRepertoire.html#planning" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Ik volg de tutorial eerst zoals die er staat, met voorbeeld files. Daarna maak ik gebruik van data afkomstig van een onderzoek op NCBI. Om de analyse context en betekenis te kunnen geven bestudeer ik de (relevante) gebruikte technieken. Met hierbij de vragen: wat is het doel van het gehele onderzoek? Welke deelvraag beantwoord deze analyse van het onderzoek? En hoe is de gebruikte data gegenereerd? Zie tabel 1 voor de volledige uitwerking.</p>
<table>
<caption>(#tab:tibble planning)Planning voor analyse met scRepertoire</caption>
<colgroup>
<col width="7%" />
<col width="83%" />
<col width="8%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Datum</th>
<th align="left">Doel</th>
<th align="left">Tijd (uren)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">23-11-2024</td>
<td align="left">Installatie en setup van de package, processing van sample data</td>
<td align="left">4</td>
</tr>
<tr class="even">
<td align="left">25-11-2024</td>
<td align="left">Basis klonale visualisatie plots op sample data</td>
<td align="left">4</td>
</tr>
<tr class="odd">
<td align="left">27-11-2024</td>
<td align="left">Complexe visualisatie plots op sample data</td>
<td align="left">4</td>
</tr>
<tr class="even">
<td align="left">28-11-2024</td>
<td align="left">Uitzoeken van een NCBI dataset, doel en experiment opzet van studie samenvatten. Data van gekozen studie importeren</td>
<td align="left">4</td>
</tr>
<tr class="odd">
<td align="left">30-11-2024</td>
<td align="left">Processing van data en bepalen welke analyses uitgevoerd worden</td>
<td align="left">4</td>
</tr>
<tr class="even">
<td align="left">2-12-2024</td>
<td align="left">De gekozen scRepertoire analyses uitvoeren</td>
<td align="left">4</td>
</tr>
<tr class="odd">
<td align="left">4-12-2024</td>
<td align="left">Verder met analyseren en plotten van studie data</td>
<td align="left">4</td>
</tr>
<tr class="even">
<td align="left">10-12-2024</td>
<td align="left">Resultaten samenvatten en conclusies maken in context tot studie</td>
<td align="left">4</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="scRepertoire.html#cb1-1" tabindex="-1"></a><span class="do">## Installation</span></span>
<span id="cb1-2"><a href="scRepertoire.html#cb1-2" tabindex="-1"></a><span class="co">#if (!require(&quot;BiocManager&quot;, quietly = TRUE)) install.packages(&quot;BiocManager&quot;)</span></span>
<span id="cb1-3"><a href="scRepertoire.html#cb1-3" tabindex="-1"></a></span>
<span id="cb1-4"><a href="scRepertoire.html#cb1-4" tabindex="-1"></a><span class="co">#BiocManager::install(&quot;scRepertoire&quot;)</span></span>
<span id="cb1-5"><a href="scRepertoire.html#cb1-5" tabindex="-1"></a></span>
<span id="cb1-6"><a href="scRepertoire.html#cb1-6" tabindex="-1"></a><span class="fu">suppressMessages</span>(<span class="fu">library</span>(scRepertoire))</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="scRepertoire.html#cb2-1" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;contig_list&quot;</span>)</span>
<span id="cb2-2"><a href="scRepertoire.html#cb2-2" tabindex="-1"></a><span class="fu">head</span>(contig_list[[<span class="dv">1</span>]])</span></code></pre></div>
<p>The output of combineTCR() will be a list of contig data frames that will be reduced to the reads associated with a single cell barcode. It will also combine the multiple reads into clone calls by either the nucleotide sequence (CTnt), amino acid sequence (CTaa), the VDJC gene sequence (CTgene), or the combination of the nucleotide and gene sequence (CTstrict).</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="scRepertoire.html#cb3-1" tabindex="-1"></a>combined.TCR <span class="ot">&lt;-</span> <span class="fu">combineTCR</span>(contig_list, </span>
<span id="cb3-2"><a href="scRepertoire.html#cb3-2" tabindex="-1"></a>                           <span class="at">samples =</span> <span class="fu">c</span>(<span class="st">&quot;P17B&quot;</span>, <span class="st">&quot;P17L&quot;</span>, <span class="st">&quot;P18B&quot;</span>, <span class="st">&quot;P18L&quot;</span>, </span>
<span id="cb3-3"><a href="scRepertoire.html#cb3-3" tabindex="-1"></a>                                            <span class="st">&quot;P19B&quot;</span>,<span class="st">&quot;P19L&quot;</span>, <span class="st">&quot;P20B&quot;</span>, <span class="st">&quot;P20L&quot;</span>),</span>
<span id="cb3-4"><a href="scRepertoire.html#cb3-4" tabindex="-1"></a>                           <span class="at">removeNA =</span> <span class="cn">FALSE</span>, </span>
<span id="cb3-5"><a href="scRepertoire.html#cb3-5" tabindex="-1"></a>                           <span class="at">removeMulti =</span> <span class="cn">FALSE</span>, </span>
<span id="cb3-6"><a href="scRepertoire.html#cb3-6" tabindex="-1"></a>                           <span class="at">filterMulti =</span> <span class="cn">FALSE</span>)</span>
<span id="cb3-7"><a href="scRepertoire.html#cb3-7" tabindex="-1"></a></span>
<span id="cb3-8"><a href="scRepertoire.html#cb3-8" tabindex="-1"></a><span class="fu">head</span>(combined.TCR[[<span class="dv">1</span>]])</span>
<span id="cb3-9"><a href="scRepertoire.html#cb3-9" tabindex="-1"></a></span>
<span id="cb3-10"><a href="scRepertoire.html#cb3-10" tabindex="-1"></a><span class="co"># additional processing, adding more variables</span></span>
<span id="cb3-11"><a href="scRepertoire.html#cb3-11" tabindex="-1"></a>combined.TCR <span class="ot">&lt;-</span> <span class="fu">addVariable</span>(combined.TCR, </span>
<span id="cb3-12"><a href="scRepertoire.html#cb3-12" tabindex="-1"></a>                            <span class="at">variable.name =</span> <span class="st">&quot;Type&quot;</span>, </span>
<span id="cb3-13"><a href="scRepertoire.html#cb3-13" tabindex="-1"></a>                            <span class="at">variables =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;B&quot;</span>, <span class="st">&quot;L&quot;</span>), <span class="dv">4</span>))</span>
<span id="cb3-14"><a href="scRepertoire.html#cb3-14" tabindex="-1"></a><span class="fu">head</span>(combined.TCR[[<span class="dv">1</span>]])</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="scRepertoire.html#cb4-1" tabindex="-1"></a><span class="fu">clonalQuant</span>(combined.TCR, </span>
<span id="cb4-2"><a href="scRepertoire.html#cb4-2" tabindex="-1"></a>            <span class="at">cloneCall=</span><span class="st">&quot;strict&quot;</span>, </span>
<span id="cb4-3"><a href="scRepertoire.html#cb4-3" tabindex="-1"></a>            <span class="at">chain =</span> <span class="st">&quot;both&quot;</span>, </span>
<span id="cb4-4"><a href="scRepertoire.html#cb4-4" tabindex="-1"></a>            <span class="at">scale =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/clonal%20plot-1.png" width="672" /></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="scRepertoire.html#cb5-1" tabindex="-1"></a><span class="fu">clonalLength</span>(combined.TCR, </span>
<span id="cb5-2"><a href="scRepertoire.html#cb5-2" tabindex="-1"></a>             <span class="at">cloneCall=</span><span class="st">&quot;aa&quot;</span>, </span>
<span id="cb5-3"><a href="scRepertoire.html#cb5-3" tabindex="-1"></a>             <span class="at">chain =</span> <span class="st">&quot;both&quot;</span>) </span></code></pre></div>
<p><img src="_main_files/figure-html/clonal%20plot-2.png" width="672" /></p>
</div>
<div id="bronvermelding" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Bronvermelding<a href="scRepertoire.html#bronvermelding" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p><em>Borcherding, N, Yang, Q, &amp; Safina, K. (2024). scRepertoire v2: A toolkit for single-cell immune receptor profiling. DOI: 10.18129/B9.bioc.scRepertoire <a href="https://github.com/ncborcherding/scRepertoire">https://github.com/ncborcherding/scRepertoire</a> </em></p></li>
<li><p><em>Borcherding N.,(2023). Starting work with scRepertoire. <a href="https://www.bioconductor.org/packages/devel/bioc/vignettes/scRepertoire/inst/doc/vignette.html">https://www.bioconductor.org/packages/devel/bioc/vignettes/scRepertoire/inst/doc/vignette.html</a>. </em></p></li>
<li><p><em>CeGaT GmbH. (2024, 11 november). Single-Cell immune profiling. <a href="https://cegat.com/research-pharma-solutions/immunology/single-cell-immune-profiling/">https://cegat.com/research-pharma-solutions/immunology/single-cell-immune-profiling/</a></em></p></li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="CV.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="Ga.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
